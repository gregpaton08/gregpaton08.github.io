---
layout: page
excerpt: Outlet that can be controlled through a web interface.
---

<div class="about">

  <p>
    <a href="https://github.com/gregpaton08/Light-Switch-Server" target="_blank">
      <span class="icon icon--github">{% include icon-github.svg %}</span>
    </a>
  </p>

  <h2>
    Problem
  </h2>
  <p>
    Ever been laying in bed and realize you forgot to turn the light off? Well I have. Apparently one to many times because I chose to take matters into my own hands...
  </p>

  <h2>
    Solution
  </h2>
  <p>
    I was wandering through Target one day and came across a <a href="https://www.amazon.com/Westinghouse-28068-Indoor-2-outlet-Remote/dp/B00I7B9KIM" target="_blank">remote controlled outlet</a> sitting in a clearance bin. Huzzah! My problems were solved. I could control my pesky light with a remote. But why stop there? Why not control it from my phone, through the web?
  </p>
  <p>
    This was the spark that started it all, but I've sinced upgraded to more robust hardware. The major problem with using a third party remote controlled outlet was that there was no way to poll the switch to get its current status. I had no way of knowing whether the light was on or off, other than of course looking at it. So, I ended building my own solution from the ground up using a popular hardware stack used in various tutorials online.
  </p>

  <h2>
    Hardware
  </h2>
  <p>
    The hardware is on its second iteration. You can see version 1.0 <a href="{{ site.baseurl }}{% link light-switch-hardware-v1.html %}">here</a>.
  </p>
  <p>
    The hardware uses two nrf24l01 radios, one connected to a Raspberry Pi acting as a control hub, the other connected to an Arduino controlling a relay to turn the light on and off. The pinout for the Raspberry Pi and the schematic for the Arduino hardware can be seen here.
  </p>
  <p>
    {% highlight python %}
### NRF24l01 pinout
# 1 GND  =>  ground
# 2 VCC  =>  3.3V
# 3 CE   =>  GPIO22
# 4 CSN  =>  SPI CE0
# 5 SCK  =>  CPI CLK
# 6 MOSI =>  SPI MOSI
# 7 MISO =>  SPI MISO
# 8 IRQ  =>  ?{% endhighlight %}
  </p>
  <p>
    <img src="{{ site.url }}/assets/light-switch/light-switch-schematic.svg">
  </p>
  <p>
    Here's a few pics of the completed hardware. Excuse the sloppy wiring, it is a prototype after all.
  </p>
  <div>
    <div class="side-by-side">
      <img src="{{ site.url }}/assets/light-switch/hardware-front.jpg" alt="switch hardware front" title="switch hardware front">
    </div>
    <div class="side-by-side">
      <img src="{{ site.url }}/assets/light-switch/hardware-back.jpg" alt="switch hardware back" title="switch hardware back">
    </div>
  </div>
  <h2>
    Web Interface
  </h2>
  <p>
    I wrote a simple interface to control the light as well as display the current status. Not much else to say, just checkout the video below.
  </p>
  <p>
    <video class="light-switch-video" autoplay loop muted playsinline>
      <source src="{{ site.url }}/assets/LightSwitch.mp4" type="video/mp4">
    </video>
  </p>

</div>

<script type="text/javascript">
  // Add controls to video if browser is Safari.
  if (navigator.vendor == "Apple Computer, Inc.") {
    var video = document.getElementsByTagName("video")[0];
    video.setAttribute("controls","controls");
  }
</script>
